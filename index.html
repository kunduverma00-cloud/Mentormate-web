<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentorMate - Learning Management System</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
    <!-- Firebase Connection Status -->
    <div id="firebaseStatus" class="firebase-status">
        <span class="status-dot"></span>
        <span class="status-text">Connecting...</span>
    </div>

    <!-- Role Selection Screen -->
    <div id="roleSelectionScreen" class="screen active">
        <div class="container">
            <div class="welcome-header">
                <h1>ğŸ“ MentorMate</h1>
                <p>Advanced Learning Management System</p>
            </div>
            <div class="role-cards">
                <div class="role-card" onclick="selectRole('student')">
                    <div class="role-icon">ğŸ‘¨â€ğŸ“</div>
                    <h3>Student Dashboard</h3>
                    <p>Check-in to routines, take tests, track progress</p>
                </div>
                <div class="role-card" onclick="selectRole('mentor')">
                    <div class="role-icon">ğŸ‘¨â€ğŸ«</div>
                    <h3>Mentor Panel</h3>
                    <p>Create tests, monitor students, view analytics</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Mentor Login Screen -->
    <div id="mentorLoginScreen" class="screen">
        <div class="container">
            <div class="login-card">
                <h2>ğŸ” Mentor Access</h2>
                <p>Enter password to access mentor panel</p>
                <div class="form-group">
                    <input type="password" id="mentorPasswordInput" class="form-input" placeholder="Enter mentor password" onkeypress="handlePasswordKeypress(event)">
                    <div id="passwordError" class="error-message"></div>
                </div>
                <div class="button-group">
                    <button onclick="verifyMentorPassword()" class="btn btn-primary">Login</button>
                    <button onclick="backToRoleSelection()" class="btn btn-secondary">Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="screen">
        <div class="dashboard-header">
            <div class="container">
                <div class="header-content">
                    <h1>ğŸ‘¨â€ğŸ“ Student Dashboard</h1>
                    <div class="header-info">
                        <span class="current-time" id="studentTime"></span>
                        <button onclick="backToRoleSelection()" class="btn btn-outline">Logout</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            <div class="container">
                <!-- Navigation Tabs -->
                <div class="section-tabs">
                    <button class="tab-btn active" onclick="showSection('routines')">
                        ğŸƒ Daily Routines
                    </button>
                    <button class="tab-btn" onclick="showSection('tests')">
                        ğŸ“‹ Tests
                    </button>
                    <button class="tab-btn" onclick="showSection('progress')">
                        ğŸ“ˆ Progress
                    </button>
                </div>

                <!-- Daily Routines Section -->
                <div id="routinesSection" class="content-section active">
                    <!-- Points Display -->
                    <div class="points-card">
                        <div class="points-info">
                            <h3>Total Points</h3>
                            <div class="points-value" id="studentPoints">0</div>
                        </div>
                    </div>

                    <!-- Today's Routines -->
                    <div class="section">
                        <h2>ğŸƒ Today's Routines</h2>
                        <div id="studentRoutines" class="routines-grid">
                            <!-- Routines will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Tests Section -->
                <div id="testsSection" class="content-section">
                    <div class="section">
                        <h2>ğŸ“‹ Available Tests</h2>
                        <div id="availableTests" class="tests-grid">
                            <!-- Tests will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Progress Section -->
                <div id="progressSection" class="content-section">
                    <div class="section">
                        <h2>ğŸ“ˆ My Progress</h2>
                        <div class="progress-stats">
                            <div class="stat-card">
                                <div class="stat-value" id="completedRoutines">0</div>
                                <div class="stat-label">Completed Today</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="testsTaken">0</div>
                                <div class="stat-label">Tests Taken</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="averageScore">0%</div>
                                <div class="stat-label">Average Score</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="totalPunishments">0</div>
                                <div class="stat-label">Total Punishments</div>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="section">
                            <h3>ğŸ“‹ Recent Activity</h3>
                            <div id="studentActivity" class="activity-feed">
                                <!-- Student activity will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mentor Dashboard -->
    <div id="mentorDashboard" class="screen">
        <div class="dashboard-header">
            <div class="container">
                <div class="header-content">
                    <h1>Mentor Control Panel</h1>
                    <div class="header-info">
                        <span class="current-time" id="mentorTime"></span>
                        <button onclick="backToRoleSelection()" class="btn btn-outline">Logout</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            <div class="container">
                <!-- Mentor Navigation Tabs -->
                <div class="section-tabs">
                    <button class="tab-btn active" onclick="showMentorSection('overview')">
                        ğŸ“Š Overview
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('routines')">
                        ğŸƒ Routines
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('tests')">
                        ğŸ“‹ Tests
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('punishments')">
                        âš–ï¸ Punishments
                    </button>
                </div>

                <!-- Overview Section -->
                <div id="mentorOverviewSection" class="content-section active">
                    <!-- Quick Actions -->
                    <div class="action-cards">
                        <div class="action-card" onclick="showCreateTestModal()">
                            <div class="action-icon">ğŸ“</div>
                            <h3>Create Test</h3>
                            <p>Design new assessments</p>
                        </div>
                        <div class="action-card" onclick="showAddRoutineModal()">
                            <div class="action-icon">ğŸ“…</div>
                            <h3>Add Routine</h3>
                            <p>Schedule new activities</p>
                        </div>
                        <div class="action-card" onclick="showStudentAnalytics()">
                            <div class="action-icon">ğŸ“Š</div>
                            <h3>Analytics</h3>
                            <p>View student performance</p>
                        </div>
                        <div class="action-card" onclick="showNotifications()">
                            <div class="action-icon">ğŸ””</div>
                            <h3>Notifications</h3>
                            <p id="notificationCount">0 new alerts</p>
                        </div>
                    </div>

                    <!-- Recent Activity Feed -->
                    <div class="section">
                        <h2>ğŸ“‹ Recent Activity</h2>
                        <div id="activityFeed" class="activity-feed">
                            <!-- Activity feed will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Routines Management Section -->
                <div id="mentorRoutinesSection" class="content-section">
                    <div class="section">
                        <h2>âš™ï¸ Manage Routines</h2>
                        <div id="routineManager" class="routine-manager">
                            <!-- Routine management will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Tests Management Section -->
                <div id="mentorTestsSection" class="content-section">
                    <div class="section">
                        <h2>ğŸ“„ Student Test Reports</h2>
                        <div id="testReports" class="reports-grid">
                            <!-- Test reports will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Punishments Management Section -->
                <div id="mentorPunishmentsSection" class="content-section">
                    <div class="section">
                        <h2>âš–ï¸ Punishment Management</h2>
                        <div class="punishment-controls">
                            <button onclick="showPunishmentModal()" class="btn btn-primary">
                                â• Add Punishment Rule
                            </button>
                            <button onclick="showStudentPunishments()" class="btn btn-secondary">
                                ğŸ“‹ View Student Punishments
                            </button>
                        </div>
                        <div id="punishmentsList" class="punishments-list">
                            <!-- Punishments will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- Manual Late Time Entry Modal -->
    <div id="lateTimeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>â° Check-in Time</h3>
                <button onclick="closeModal('lateTimeModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="late-time-info">
                    <h4 id="routineName">Routine Check-in</h4>
                    <p>How many minutes late are you?</p>
                </div>
                <div class="time-buttons">
                    <button class="time-btn" onclick="selectLateTime(0)">
                        <div class="time-value">0 min</div>
                        <div class="time-label">On Time</div>
                    </button>
                    <button class="time-btn" onclick="selectLateTime(1)">
                        <div class="time-value">1 min</div>
                        <div class="time-label">Slightly Late</div>
                    </button>
                    <button class="time-btn" onclick="selectLateTime(5)">
                        <div class="time-value">5 min</div>
                        <div class="time-label">A bit Late</div>
                    </button>
                    <button class="time-btn" onclick="selectLateTime(10)">
                        <div class="time-value">10 min</div>
                        <div class="time-label">Moderately Late</div>
                    </button>
                    <button class="time-btn" onclick="selectLateTime(20)">
                        <div class="time-value">20 min</div>
                        <div class="time-label">Very Late</div>
                    </button>
                    <button class="time-btn" onclick="selectLateTime(30)">
                        <div class="time-value">30 min</div>
                        <div class="time-label">Extremely Late</div>
                    </button>
                </div>
                <div class="custom-time-input">
                    <label>Or enter custom minutes:</label>
                    <input type="number" id="customLateTime" class="form-input" min="0" max="120" placeholder="Enter minutes">
                    <button onclick="selectCustomTime()" class="btn btn-secondary btn-small">Use Custom</button>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('lateTimeModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Punishment Modal -->
    <div id="punishmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>âš–ï¸ Add Punishment Rule</h3>
                <button onclick="closeModal('punishmentModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Punishment Name</label>
                    <input type="text" id="punishmentName" class="form-input" placeholder="e.g., Extra Exercise">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="punishmentDescription" class="form-input" rows="3" placeholder="Describe the punishment"></textarea>
                </div>
                <div class="form-group">
                    <label>Late Time Range (minutes)</label>
                    <div class="range-inputs">
                        <input type="number" id="punishmentMinTime" class="form-input" placeholder="From (min)" min="0">
                        <span>to</span>
                        <input type="number" id="punishmentMaxTime" class="form-input" placeholder="To (min)" min="0">
                    </div>
                </div>
                <div class="form-group">
                    <label>Severity Level</label>
                    <select id="punishmentSeverity" class="form-input">
                        <option value="minor">Minor</option>
                        <option value="moderate">Moderate</option>
                        <option value="severe">Severe</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="savePunishmentRule()" class="btn btn-primary">Save Rule</button>
                <button onclick="closeModal('punishmentModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Create Test Modal -->
    <div id="createTestModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“ Create New Test</h3>
                <button onclick="closeModal('createTestModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Test Title</label>
                    <input type="text" id="testTitle" class="form-input" placeholder="e.g., Weekly Math Assessment">
                </div>
                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="testDuration" class="form-input" value="30" min="5" max="180">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="testCategory" class="form-input">
                        <option value="Academic">Academic</option>
                        <option value="General Knowledge">General Knowledge</option>
                        <option value="Practice">Practice</option>
                    </select>
                </div>
                <div class="questions-section">
                    <div class="section-header">
                        <h4>Questions</h4>
                        <button onclick="addQuestion()" class="btn btn-small">+ Add Question</button>
                    </div>
                    <div id="questionsContainer">
                        <!-- Questions will be added here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="saveTest()" class="btn btn-primary">Create Test</button>
                <button onclick="closeModal('createTestModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Routine Modal -->
    <div id="addRoutineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“… Add New Routine</h3>
                <button onclick="closeModal('addRoutineModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Routine Name</label>
                    <input type="text" id="routineName" class="form-input" placeholder="e.g., Morning Exercise">
                </div>
                <div class="form-group">
                    <label>Start Time</label>
                    <input type="time" id="routineStartTime" class="form-input">
                </div>
                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="routineDuration" class="form-input" value="30" min="5">
                </div>
                <div class="form-group">
                    <label>Points</label>
                    <input type="number" id="routinePoints" class="form-input" value="10" min="1">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="routineCategory" class="form-input">
                        <option value="Health">Health</option>
                        <option value="Education">Education</option>
                        <option value="Personal">Personal</option>
                        <option value="Recreation">Recreation</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="saveRoutine()" class="btn btn-primary">Add Routine</button>
                <button onclick="closeModal('addRoutineModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Routine Modal -->
    <div id="editRoutineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>âœï¸ Edit Routine</h3>
                <button onclick="closeModal('editRoutineModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Routine Name</label>
                    <input type="text" id="editRoutineName" class="form-input" placeholder="e.g., Morning Exercise">
                </div>
                <div class="form-group">
                    <label>Start Time</label>
                    <input type="time" id="editRoutineStartTime" class="form-input">
                </div>
                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="editRoutineDuration" class="form-input" value="30" min="5">
                </div>
                <div class="form-group">
                    <label>Points</label>
                    <input type="number" id="editRoutinePoints" class="form-input" value="10" min="1">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="editRoutineCategory" class="form-input">
                        <option value="Health">Health</option>
                        <option value="Education">Education</option>
                        <option value="Personal">Personal</option>
                        <option value="Recreation">Recreation</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="updateRoutine()" class="btn btn-primary">Update Routine</button>
                <button onclick="closeModal('editRoutineModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Test Taking Modal -->
    <div id="testTakingModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="testTakingTitle">Taking Test</h3>
                <div class="test-timer">
                    <span>â±ï¸ Time: </span>
                    <span id="testTimeRemaining">30:00</span>
                </div>
            </div>
            <div class="modal-body">
                <div class="test-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="testProgress"></div>
                    </div>
                    <div class="progress-text" id="progressText">Question 1 of 10</div>
                </div>
                <div id="testQuestionsContainer">
                    <!-- Test questions will be populated here -->
                </div>
                <div class="test-navigation">
                    <button id="prevQuestionBtn" onclick="previousQuestion()" class="btn btn-secondary">Previous</button>
                    <span id="questionCounter">Question 1 of 10</span>
                    <button id="nextQuestionBtn" onclick="nextQuestion()" class="btn btn-secondary">Next</button>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="submitTest()" class="btn btn-primary" id="submitTestBtn">Submit Test</button>
                <button onclick="closeTestModal()" class="btn btn-danger">Exit Test</button>
            </div>
        </div>
    </div>

    <!-- Test Result Modal -->
    <div id="testResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ‰ Test Completed!</h3>
                <button onclick="closeModal('testResultModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="result-summary">
                    <div class="result-score" id="resultScore">85%</div>
                    <div class="result-details" id="resultDetails">8/10 Questions Correct</div>
                    <div class="result-message" id="resultMessage">Great job!</div>
                </div>
                <div class="result-breakdown" id="resultBreakdown">
                    <!-- Detailed breakdown will be shown here -->
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('testResultModal')" class="btn btn-primary">Continue</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>