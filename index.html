<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentorMate Pro - Professional Learning Management</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
    <!-- Firebase Connection Status -->
    <div id="firebaseStatus" class="firebase-status">
        <span class="status-dot"></span>
        <span class="status-text">Connecting...</span>
    </div>

    <!-- Role Selection Screen -->
    <div id="roleSelectionScreen" class="screen active">
        <div class="container">
            <div class="welcome-header">
                <h1>üéì MentorMate Pro</h1>
                <p>Professional Learning Management System</p>
            </div>
            <div class="role-cards">
                <div class="role-card" onclick="selectRole('student')">
                    <div class="role-icon">üë®‚Äçüéì</div>
                    <h3>Student Dashboard</h3>
                    <p>Smart session tracking, live progress, analytics</p>
                </div>
                <div class="role-card" onclick="selectRole('mentor')">
                    <div class="role-icon">üë®‚Äçüè´</div>
                    <h3>Mentor Panel</h3>
                    <p>Professional analytics, session monitoring, insights</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Mentor Login Screen -->
    <div id="mentorLoginScreen" class="screen">
        <div class="container">
            <div class="login-card">
                <h2>üîê Mentor Access</h2>
                <p>Enter password to access professional mentor panel</p>
                <div class="form-group">
                    <input type="password" id="mentorPasswordInput" class="form-input" placeholder="Enter mentor password" onkeypress="handlePasswordKeypress(event)">
                    <div id="passwordError" class="error-message"></div>
                </div>
                <div class="button-group">
                    <button onclick="verifyMentorPassword()" class="btn btn-primary">Login</button>
                    <button onclick="backToRoleSelection()" class="btn btn-secondary">Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="screen">
        <div class="dashboard-header">
            <div class="container">
                <div class="header-content">
                    <h1>üë®‚Äçüéì Student Dashboard</h1>
                    <div class="header-info">
                        <span class="current-time" id="studentTime"></span>
                        <button onclick="backToRoleSelection()" class="btn btn-outline">Logout</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            <div class="container">
                <!-- Navigation Tabs -->
                <div class="section-tabs">
                    <button class="tab-btn active" onclick="showSection('routines')">
                        üèÉ Smart Sessions
                    </button>
                    <button class="tab-btn" onclick="showSection('tests')">
                        üìã Tests
                    </button>
                    <button class="tab-btn" onclick="showSection('progress')">
                        üìà Analytics
                    </button>
                </div>

                <!-- Smart Sessions Section -->
                <div id="routinesSection" class="content-section active">
                    <!-- Points Display -->
                    <div class="points-grid">
                        <div class="points-card">
                            <div class="points-info">
                                <h3>Today's Points</h3>
                                <div class="points-value" id="studentPoints">0</div>
                                <div class="points-label">Earned Today</div>
                            </div>
                        </div>
                        <div class="points-card secondary">
                            <div class="points-info">
                                <h3>Session Time</h3>
                                <div class="points-value" id="totalSessionTime">0m</div>
                                <div class="points-label">Today Total</div>
                            </div>
                        </div>
                    </div>

                    <!-- Active Session Monitor -->
                    <div id="activeSessionMonitor" class="active-session-monitor" style="display: none;">
                        <div class="session-monitor-header">
                            <h3>üî¥ Live Session</h3>
                            <div class="session-controls">
                                <button onclick="pauseSession()" class="btn btn-warning btn-small" id="pauseBtn">‚è∏Ô∏è Check Out</button>
                                <button onclick="stopSession()" class="btn btn-danger btn-small">‚èπÔ∏è End Session</button>
                            </div>
                        </div>
                        <div class="session-monitor-body">
                            <div class="session-progress">
                                <div class="progress-circle">
                                    <div class="progress-ring">
                                        <svg class="progress-svg" width="120" height="120">
                                            <circle class="progress-ring-background" cx="60" cy="60" r="54"></circle>
                                            <circle class="progress-ring-fill" cx="60" cy="60" r="54" id="progressRingFill"></circle>
                                        </svg>
                                        <div class="progress-text">
                                            <div class="session-time" id="activeSessionTime">00:00</div>
                                            <div class="session-percentage" id="sessionPercentage">0%</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="session-details">
                                    <div class="session-info">
                                        <h4 id="activeSessionName">Current Session</h4>
                                        <div class="session-stats">
                                            <div class="stat">
                                                <span class="stat-label">Target:</span>
                                                <span class="stat-value" id="targetDuration">0 min</span>
                                            </div>
                                            <div class="stat">
                                                <span class="stat-label">Elapsed:</span>
                                                <span class="stat-value" id="elapsedTime">0 min</span>
                                            </div>
                                            <div class="stat">
                                                <span class="stat-label">Points Earned:</span>
                                                <span class="stat-value" id="currentPoints">0</span>
                                            </div>
                                            <div class="stat">
                                                <span class="stat-label">Status:</span>
                                                <span class="stat-value" id="sessionStatus">Active</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Paused Session Resume -->
                    <div id="pausedSessionResume" class="paused-session-resume" style="display: none;">
                        <div class="paused-header">
                            <h3>‚è∏Ô∏è Session Paused</h3>
                            <button onclick="resumeSession()" class="btn btn-success">‚ñ∂Ô∏è Resume Session</button>
                        </div>
                        <div class="paused-info">
                            <div class="paused-details">
                                <span id="pausedSessionName">Session Name</span>
                                <span id="pausedSessionTime">Paused at: 15:30</span>
                            </div>
                        </div>
                    </div>

                    <!-- Available Sessions -->
                    <div class="section">
                        <h2>üèÉ Smart Learning Sessions</h2>
                        <div id="studentRoutines" class="routines-grid">
                            <!-- Routines will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Tests Section -->
                <div id="testsSection" class="content-section">
                    <div class="section">
                        <h2>üìã Available Tests</h2>
                        <div id="availableTests" class="tests-grid">
                            <!-- Tests will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Analytics Section -->
                <div id="progressSection" class="content-section">
                    <div class="section">
                        <h2>üìà Personal Analytics</h2>

                        <!-- Weekly Summary -->
                        <div class="analytics-summary">
                            <div class="summary-card">
                                <h3>üìä This Week</h3>
                                <div class="summary-stats">
                                    <div class="summary-stat">
                                        <div class="stat-value" id="weeklyPoints">0</div>
                                        <div class="stat-label">Points Earned</div>
                                    </div>
                                    <div class="summary-stat">
                                        <div class="stat-value" id="weeklyHours">0h</div>
                                        <div class="stat-label">Study Hours</div>
                                    </div>
                                    <div class="summary-stat">
                                        <div class="stat-value" id="weeklySessions">0</div>
                                        <div class="stat-label">Sessions</div>
                                    </div>
                                    <div class="summary-stat">
                                        <div class="stat-value" id="weeklyAverage">0%</div>
                                        <div class="stat-label">Efficiency</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Daily Breakdown -->
                        <div class="section">
                            <h3>üìÖ Daily Progress</h3>
                            <div class="daily-breakdown">
                                <div class="daily-chart" id="dailyChart">
                                    <!-- Daily progress chart will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Progress Stats -->
                        <div class="progress-stats">
                            <div class="stat-card">
                                <div class="stat-value" id="completedRoutines">0</div>
                                <div class="stat-label">Sessions Today</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="testsTaken">0</div>
                                <div class="stat-label">Tests Taken</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="averageScore">0%</div>
                                <div class="stat-label">Test Average</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="totalPunishments">0</div>
                                <div class="stat-label">Punishments</div>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="section">
                            <h3>üìã Recent Activity</h3>
                            <div id="studentActivity" class="activity-feed">
                                <!-- Student activity will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mentor Dashboard -->
    <div id="mentorDashboard" class="screen">
        <div class="dashboard-header">
            <div class="container">
                <div class="header-content">
                    <h1>üë®‚Äçüè´ Professional Mentor Panel</h1>
                    <div class="header-info">
                        <span class="current-time" id="mentorTime"></span>
                        <button onclick="backToRoleSelection()" class="btn btn-outline">Logout</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            <div class="container">
                <!-- Mentor Navigation Tabs -->
                <div class="section-tabs">
                    <button class="tab-btn active" onclick="showMentorSection('analytics')">
                        üìä Student Analytics
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('sessions')">
                        üî¥ Live Sessions
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('routines')">
                        üèÉ Manage Routines
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('tests')">
                        üìã Tests & Reports
                    </button>
                    <button class="tab-btn" onclick="showMentorSection('punishments')">
                        ‚öñÔ∏è Punishments
                    </button>
                </div>

                <!-- Student Analytics Section -->
                <div id="mentorAnalyticsSection" class="content-section active">
                    <div class="professional-analytics">
                        <!-- Performance Overview -->
                        <div class="analytics-overview">
                            <h2>üìä Student Performance Overview</h2>
                            <div class="overview-cards">
                                <div class="overview-card">
                                    <div class="card-header">
                                        <h3>Today's Performance</h3>
                                        <span class="date-label" id="todayDate"></span>
                                    </div>
                                    <div class="card-stats">
                                        <div class="main-stat">
                                            <div class="stat-number" id="todayPointsEarned">0</div>
                                            <div class="stat-unit">Points</div>
                                        </div>
                                        <div class="sub-stats">
                                            <div class="sub-stat">
                                                <span class="sub-value" id="todaySessionTime">0h 0m</span>
                                                <span class="sub-label">Study Time</span>
                                            </div>
                                            <div class="sub-stat">
                                                <span class="sub-value" id="todaySessionsCount">0</span>
                                                <span class="sub-label">Sessions</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="overview-card">
                                    <div class="card-header">
                                        <h3>Weekly Summary</h3>
                                        <span class="date-label">This Week</span>
                                    </div>
                                    <div class="card-stats">
                                        <div class="main-stat">
                                            <div class="stat-number" id="weeklyPointsTotal">0</div>
                                            <div class="stat-unit">Points</div>
                                        </div>
                                        <div class="sub-stats">
                                            <div class="sub-stat">
                                                <span class="sub-value" id="weeklyStudyTime">0h</span>
                                                <span class="sub-label">Total Time</span>
                                            </div>
                                            <div class="sub-stat">
                                                <span class="sub-value" id="weeklyAvgDaily">0</span>
                                                <span class="sub-label">Avg/Day</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="overview-card">
                                    <div class="card-header">
                                        <h3>Performance Trend</h3>
                                        <span class="date-label">Last 7 Days</span>
                                    </div>
                                    <div class="card-stats">
                                        <div class="main-stat">
                                            <div class="stat-number" id="performanceTrend">+15%</div>
                                            <div class="stat-unit">Change</div>
                                        </div>
                                        <div class="trend-indicator" id="trendIndicator">
                                            <span class="trend-arrow">üìà</span>
                                            <span class="trend-text">Improving</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Analytics Charts -->
                        <div class="analytics-charts">
                            <div class="chart-section">
                                <h3>üìà Daily Points Trend</h3>
                                <div class="chart-container">
                                    <div id="dailyPointsChart" class="chart-area">
                                        <!-- Chart will be populated here -->
                                    </div>
                                </div>
                            </div>

                            <div class="chart-section">
                                <h3>‚è±Ô∏è Study Time Analysis</h3>
                                <div class="chart-container">
                                    <div id="studyTimeChart" class="chart-area">
                                        <!-- Chart will be populated here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Performance Table -->
                        <div class="performance-table-section">
                            <h3>üìä Detailed Performance Log</h3>
                            <div class="table-container">
                                <table class="performance-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Sessions</th>
                                            <th>Study Time</th>
                                            <th>Points Earned</th>
                                            <th>Efficiency</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="performanceTableBody">
                                        <!-- Table rows will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Sessions Monitoring -->
                <div id="mentorSessionsSection" class="content-section">
                    <div class="section">
                        <h2>üî¥ Live Session Monitoring</h2>
                        <div id="liveSessionsMonitor" class="live-sessions-monitor">
                            <!-- Live sessions will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Routines Management Section -->
                <div id="mentorRoutinesSection" class="content-section">
                    <div class="section">
                        <h2>‚öôÔ∏è Manage Learning Sessions</h2>
                        <div id="routineManager" class="routine-manager">
                            <!-- Routine management will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Tests Management Section -->
                <div id="mentorTestsSection" class="content-section">
                    <div class="section">
                        <h2>üìÑ Tests & Reports</h2>
                        <div id="testReports" class="reports-grid">
                            <!-- Test reports will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Punishments Management Section -->
                <div id="mentorPunishmentsSection" class="content-section">
                    <div class="section">
                        <h2>‚öñÔ∏è Punishment Management</h2>
                        <div id="punishmentsList" class="punishments-list">
                            <!-- Punishments will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- All previous modals remain the same -->
    <!-- Create Test Modal -->
    <div id="createTestModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìù Create New Test</h3>
                <button onclick="closeModal('createTestModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Test Title</label>
                    <input type="text" id="testTitle" class="form-input" placeholder="e.g., Weekly Math Assessment">
                </div>
                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="testDuration" class="form-input" value="30" min="5" max="180">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="testCategory" class="form-input">
                        <option value="Academic">Academic</option>
                        <option value="General Knowledge">General Knowledge</option>
                        <option value="Practice">Practice</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="saveTest()" class="btn btn-primary">Create Test</button>
                <button onclick="closeModal('createTestModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Routine Modal -->
    <div id="addRoutineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìÖ Add New Learning Session</h3>
                <button onclick="closeModal('addRoutineModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Session Name</label>
                    <input type="text" id="routineName" class="form-input" placeholder="e.g., Morning Study Session">
                </div>
                <div class="form-group">
                    <label>Start Time</label>
                    <input type="time" id="routineStartTime" class="form-input">
                </div>
                <div class="form-group">
                    <label>Target Duration (minutes)</label>
                    <input type="number" id="routineDuration" class="form-input" value="60" min="15">
                </div>
                <div class="form-group">
                    <label>Points per Hour</label>
                    <input type="number" id="routinePoints" class="form-input" value="12" min="1">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="routineCategory" class="form-input">
                        <option value="Education">Education</option>
                        <option value="Health">Health</option>
                        <option value="Personal">Personal Development</option>
                        <option value="Skills">Skills Training</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="saveRoutine()" class="btn btn-primary">Add Session</button>
                <button onclick="closeModal('addRoutineModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Routine Modal -->
    <div id="editRoutineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Learning Session</h3>
                <button onclick="closeModal('editRoutineModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Session Name</label>
                    <input type="text" id="editRoutineName" class="form-input">
                </div>
                <div class="form-group">
                    <label>Start Time</label>
                    <input type="time" id="editRoutineStartTime" class="form-input">
                </div>
                <div class="form-group">
                    <label>Target Duration (minutes)</label>
                    <input type="number" id="editRoutineDuration" class="form-input" min="15">
                </div>
                <div class="form-group">
                    <label>Points per Hour</label>
                    <input type="number" id="editRoutinePoints" class="form-input" min="1">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="editRoutineCategory" class="form-input">
                        <option value="Education">Education</option>
                        <option value="Health">Health</option>
                        <option value="Personal">Personal Development</option>
                        <option value="Skills">Skills Training</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="updateRoutine()" class="btn btn-primary">Update Session</button>
                <button onclick="closeModal('editRoutineModal')" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Test Taking and Result Modals remain the same -->
    <div id="testTakingModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="testTakingTitle">Taking Test</h3>
                <div class="test-timer">
                    <span>‚è±Ô∏è Time: </span>
                    <span id="testTimeRemaining">30:00</span>
                </div>
            </div>
            <div class="modal-body">
                <div class="test-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="testProgress"></div>
                    </div>
                    <div class="progress-text" id="progressText">Question 1 of 10</div>
                </div>
                <div id="testQuestionsContainer"></div>
                <div class="test-navigation">
                    <button id="prevQuestionBtn" onclick="previousQuestion()" class="btn btn-secondary">Previous</button>
                    <span id="questionCounter">Question 1 of 10</span>
                    <button id="nextQuestionBtn" onclick="nextQuestion()" class="btn btn-secondary">Next</button>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="submitTest()" class="btn btn-primary">Submit Test</button>
                <button onclick="closeTestModal()" class="btn btn-danger">Exit Test</button>
            </div>
        </div>
    </div>

    <div id="testResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üéâ Test Completed!</h3>
                <button onclick="closeModal('testResultModal')" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="result-summary">
                    <div class="result-score" id="resultScore">85%</div>
                    <div class="result-details" id="resultDetails">8/10 Questions Correct</div>
                    <div class="result-message" id="resultMessage">Great job!</div>
                </div>
                <div class="result-breakdown" id="resultBreakdown"></div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('testResultModal')" class="btn btn-primary">Continue</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>