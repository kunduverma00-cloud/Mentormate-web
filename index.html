<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentorMate Pro - Professional Learning Management System</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <!-- Firebase Connection Status -->
    <div id="firebaseStatus" class="firebase-status">
        <div class="status-dot"></div>
        <span class="status-text">Connecting...</span>
    </div>

    <!-- Role Selection Screen -->
    <div id="roleSelectionScreen" class="screen active">
        <div class="container">
            <div class="welcome-header">
                <h1>🎓 MentorMate Pro</h1>
                <p>Professional Learning Management System</p>
            </div>
            <div class="role-cards">
                <div class="role-card" onclick="selectRole('student')">
                    <div class="role-icon">👨‍🎓</div>
                    <h3>Student Dashboard</h3>
                    <p>Smart session tracking, live progress, analytics</p>
                </div>
                <div class="role-card" onclick="selectRole('mentor')">
                    <div class="role-icon">👨‍🏫</div>
                    <h3>Mentor Panel</h3>
                    <p>Professional analytics, session monitoring, insights</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Mentor Login Screen -->
    <div id="mentorLoginScreen" class="screen">
        <div class="container">
            <div class="login-card">
                <h2>🔐 Mentor Login</h2>
                <p>Enter password to access professional mentor panel</p>
                <div class="form-group">
                    <input 
                        type="password" 
                        id="mentorPasswordInput" 
                        placeholder="Enter mentor password"
                        class="form-input"
                        onkeypress="handlePasswordKeypress(event)"
                    >
                </div>
                <div class="button-group">
                    <button onclick="verifyMentorPassword()" class="btn btn-primary">
                        🚀 Access Panel
                    </button>
                    <button onclick="backToRoleSelection()" class="btn btn-secondary">
                        ← Back
                    </button>
                </div>
                <div id="passwordError" class="error-message"></div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="screen">
        <div class="container">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="header-content">
                    <h1>👨‍🎓 Student Dashboard</h1>
                    <div class="header-info">
                        <div id="studentTime" class="current-time">00:00:00</div>
                        <button onclick="backToRoleSelection()" class="btn btn-outline btn-small">🚪 Exit</button>
                    </div>
                </div>
            </div>

            <div class="dashboard-content">
                <!-- Active Session Monitor - REMOVED End Session button as requested -->
                <div id="activeSessionMonitor" class="active-session-monitor" style="display: none;">
                    <div class="session-monitor-header">
                        <h3>📚 Active Study Session</h3>
                        <div class="session-controls">
                            <button onclick="pauseSession()" class="btn btn-warning btn-small">⏸️ Pause</button>
                            <!-- REMOVED: End Session button completely -->
                        </div>
                    </div>

                    <div class="session-monitor-body">
                        <div class="progress-circle">
                            <svg class="progress-ring" width="120" height="120">
                                <circle cx="60" cy="60" r="54" fill="none" stroke="#e5e5e5" stroke-width="8"/>
                                <circle id="progressRingFill" cx="60" cy="60" r="54" fill="none" stroke="#667eea" 
                                        stroke-width="8" stroke-dasharray="339.292" stroke-dashoffset="339.292" 
                                        transform="rotate(-90 60 60)"/>
                            </svg>
                            <div class="progress-text">
                                <div id="activeSessionTime" class="session-time">00:00</div>
                                <div id="sessionPercentage" class="session-percentage">0%</div>
                            </div>
                        </div>

                        <div class="session-details">
                            <div class="session-info">
                                <h4 id="activeSessionName">Study Session</h4>
                                <div class="session-stats">
                                    <div class="stat">
                                        <span class="stat-label">Target</span>
                                        <span class="stat-value" id="targetDuration">90 min</span>
                                    </div>
                                    <div class="stat">
                                        <span class="stat-label">Elapsed</span>
                                        <span class="stat-value" id="elapsedTime">0 min</span>
                                    </div>
                                    <div class="stat">
                                        <span class="stat-label">Points</span>
                                        <span class="stat-value" id="currentPoints">0</span>
                                    </div>
                                    <div class="stat">
                                        <span class="stat-label">Status</span>
                                        <span class="stat-value" id="sessionStatus">Active</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Paused Session Resume - REMOVED End Session button as requested -->
                <div id="pausedSessionResume" class="paused-session-resume" style="display: none;">
                    <div class="paused-header">
                        <h3>⏸️ Session Paused</h3>
                        <div class="session-controls">
                            <button onclick="resumeSession()" class="btn btn-success btn-small">▶️ Resume</button>
                            <!-- REMOVED: End Session button completely -->
                        </div>
                    </div>
                    <div class="paused-info">
                        <div class="paused-details">
                            <strong id="pausedSessionName">Study Session</strong>
                            <span id="pausedSessionTime">Paused at: 00:00</span>
                        </div>
                    </div>
                </div>

                <!-- Section Navigation Tabs - ADDED Syllabus tab -->
                <div class="section-tabs">
                    <button class="tab-btn active" onclick="showSection('routines')">📚 Sessions</button>
                    <button class="tab-btn" onclick="showSection('tests')">📝 Tests</button>
                    <button class="tab-btn" onclick="showSection('syllabus')">📖 Syllabus</button>
                    <button class="tab-btn" onclick="showSection('progress')">📊 Progress</button>
                </div>

                <!-- Learning Sessions Section -->
                <div id="routinesSection" class="content-section active">
                    <div class="section">
                        <h2>📚 Learning Sessions</h2>
                        <div id="studentRoutines" class="routines-grid">
                            <div class="text-center">Loading sessions...</div>
                        </div>
                    </div>
                </div>

                <!-- ADDED: Syllabus Section -->
                <div id="syllabusSection" class="content-section">
                    <div class="section">
                        <h2>📖 NEET Syllabus Progress</h2>
                        <div id="syllabusContent" class="syllabus-container">
                            <div class="text-center">Loading syllabus...</div>
                        </div>
                    </div>
                </div>

                <!-- Tests Section -->
                <div id="testsSection" class="content-section">
                    <div class="section">
                        <h2>📝 Available Tests</h2>
                        <div id="availableTests" class="tests-grid">
                            <div class="text-center">Loading tests...</div>
                        </div>
                    </div>
                </div>

                <!-- Progress Section -->
                <div id="progressSection" class="content-section">
                    <div class="section">
                        <h2>📊 Your Progress</h2>

                        <!-- Points Overview -->
                        <div class="points-grid">
                            <div class="points-card">
                                <div class="points-info">
                                    <h3>Today's Points</h3>
                                    <div id="todayPoints" class="points-value">0</div>
                                    <div class="points-label">Points</div>
                                </div>
                            </div>

                            <div class="points-card secondary">
                                <div class="points-info">
                                    <h3>Yesterday's Points</h3>
                                    <div id="yesterdayPoints" class="points-value">0</div>
                                    <div class="points-label">Points</div>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Stats -->
                        <div class="progress-stats">
                            <div class="stat-card">
                                <div class="stat-value" id="totalSessionTime">0m</div>
                                <div class="stat-label">Study Time Today</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="completedSessions">0</div>
                                <div class="stat-label">Completed Sessions</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="averageEfficiency">0%</div>
                                <div class="stat-label">Average Efficiency</div>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="analytics-summary">
                            <div class="summary-card">
                                <h3>📈 Recent Activity</h3>
                                <div id="studentActivity" class="activity-container">
                                    <div class="text-center">Loading activity...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mentor Dashboard -->
    <div id="mentorDashboard" class="screen">
        <div class="container">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="header-content">
                    <h1>👨‍🏫 Professional Mentor Panel</h1>
                    <div class="header-info">
                        <div id="mentorTime" class="current-time">00:00:00</div>
                        <button onclick="backToRoleSelection()" class="btn btn-outline btn-small">🚪 Exit</button>
                    </div>
                </div>
            </div>

            <div class="dashboard-content">
                <!-- Section Navigation Tabs - ADDED Syllabus tab -->
                <div class="section-tabs">
                    <button class="tab-btn active" onclick="showMentorSection('analytics')">📊 Analytics</button>
                    <button class="tab-btn" onclick="showMentorSection('sessions')">🔴 Live Sessions</button>
                    <button class="tab-btn" onclick="showMentorSection('routines')">📚 Sessions</button>
                    <button class="tab-btn" onclick="showMentorSection('syllabus')">📖 Syllabus</button>
                    <button class="tab-btn" onclick="showMentorSection('tests')">📝 Tests</button>
                    <button class="tab-btn" onclick="showMentorSection('punishments')">⚠️ Punishments</button>
                </div>

                <!-- Analytics Section -->
                <div id="mentorAnalyticsSection" class="content-section active">
                    <div class="professional-analytics">
                        <div class="analytics-overview">
                            <h2>📊 Performance Analytics - <span id="todayDate">Today</span></h2>
                            <div class="overview-cards" id="analyticsOverview">
                                <div class="text-center">Loading analytics...</div>
                            </div>
                        </div>

                        <div class="analytics-charts">
                            <div class="chart-section">
                                <h3>📈 Weekly Breakdown</h3>
                                <div class="chart-container" id="weeklyChart">
                                    <div class="text-center">Loading chart...</div>
                                </div>
                            </div>
                        </div>

                        <div class="performance-table-section">
                            <h3>📋 Performance Table</h3>
                            <div class="table-container">
                                <table class="performance-table" id="performanceTable">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Sessions</th>
                                            <th>Study Time</th>
                                            <th>Points Earned</th>
                                            <th>Efficiency</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" style="text-align: center;">Loading data...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Sessions Monitor -->
                <div id="mentorSessionsSection" class="content-section">
                    <div class="section">
                        <h2>🔴 Live Session Monitor</h2>
                        <div class="live-sessions-monitor" id="liveSessionsContainer">
                            <div class="no-active-sessions">
                                <div class="no-session-icon">💤</div>
                                <h3>No Active Sessions</h3>
                                <p>Students will appear here when they start study sessions</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Routines Management -->
                <div id="mentorRoutinesSection" class="content-section">
                    <div class="section">
                        <div class="section-header">
                            <h2>📚 Sessions Management</h2>
                            <button onclick="openModal('addRoutineModal')" class="btn btn-primary">➕ Add Session</button>
                        </div>
                        <div id="routineManager" class="routines-grid">
                            <div class="text-center">Loading sessions...</div>
                        </div>
                    </div>
                </div>

                <!-- ADDED: Syllabus Management Section -->
                <div id="mentorSyllabusSection" class="content-section">
                    <div class="section">
                        <div class="section-header">
                            <h2>📖 Syllabus Management</h2>
                            <button onclick="openModal('addChapterModal')" class="btn btn-primary">➕ Add Chapter</button>
                        </div>
                        <div id="mentorSyllabusContent" class="mentor-syllabus-container">
                            <div class="text-center">Loading syllabus...</div>
                        </div>
                    </div>
                </div>

                <!-- Tests Section -->
                <div id="mentorTestsSection" class="content-section">
                    <div class="section">
                        <div class="section-header">
                            <h2>📝 Tests Management</h2>
                            <button onclick="openModal('addTestModal')" class="btn btn-primary">➕ Create Test</button>
                        </div>
                        <div id="testReports" class="tests-grid">
                            <div class="text-center">Loading tests...</div>
                        </div>
                    </div>
                </div>

                <!-- Punishments Section -->
                <div id="mentorPunishmentsSection" class="content-section">
                    <div class="section">
                        <h2>⚠️ Student Punishments</h2>
                        <div id="punishmentsList" class="student-punishments">
                            <div class="text-center">Loading punishments...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Routine Modal -->
    <div id="addRoutineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="routineModalTitle">Add New Session</h3>
                <button onclick="closeModal('addRoutineModal')" class="close-btn">×</button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label>Session Name</label>
                    <input type="text" id="routineName" placeholder="Enter session name" class="form-input">
                </div>

                <div class="form-group">
                    <label>Scheduled Time</label>
                    <input type="time" id="routineTime" class="form-input">
                </div>

                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="routineDuration" min="15" max="480" value="90" class="form-input">
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <select id="routineCategory" class="form-input">
                        <option value="Education">Education</option>
                        <option value="Skills">Skills</option>
                        <option value="Research">Research</option>
                        <option value="Practice">Practice</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea id="routineDescription" placeholder="Optional description" class="form-input"></textarea>
                </div>
            </div>

            <div class="modal-footer">
                <button onclick="closeModal('addRoutineModal')" class="btn btn-secondary">Cancel</button>
                <button onclick="saveRoutine()" class="btn btn-primary">Save Session</button>
            </div>
        </div>
    </div>

    <!-- ADDED: Add Chapter Modal -->
    <div id="addChapterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="addChapterModalTitle">Add New Chapter</h3>
                <button onclick="closeModal('addChapterModal')" class="close-btn">×</button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label>Chapter Name</label>
                    <input type="text" id="chapterName" placeholder="Enter chapter name" class="form-input">
                </div>

                <div class="form-group">
                    <label>Subject</label>
                    <select id="chapterSubject" class="form-input">
                        <option value="physics">⚗️ Physics</option>
                        <option value="chemistry">🧪 Chemistry</option>
                        <option value="biology">🧬 Biology</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Weightage (%)</label>
                    <input type="number" id="chapterWeight" min="1" max="50" value="5" class="form-input">
                </div>
            </div>

            <div class="modal-footer">
                <button onclick="closeModal('addChapterModal')" class="btn btn-secondary">Cancel</button>
                <button onclick="saveChapter()" class="btn btn-primary">Save Chapter</button>
            </div>
        </div>
    </div>

    <!-- Add Test Modal -->
    <div id="addTestModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Create New Test</h3>
                <button onclick="closeModal('addTestModal')" class="close-btn">×</button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label>Test Title</label>
                    <input type="text" id="testTitle" placeholder="Enter test title" class="form-input">
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <select id="testCategory" class="form-input">
                        <option value="Academic">Academic</option>
                        <option value="Skill">Skill Assessment</option>
                        <option value="Knowledge">Knowledge Check</option>
                        <option value="Practice">Practice Test</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="testDuration" min="5" max="180" value="30" class="form-input">
                </div>

                <div class="form-group">
                    <label>Questions (JSON format)</label>
                    <textarea id="testQuestions" placeholder='[{"question":"Your question?","options":["A","B","C","D"],"correctAnswer":0}]' class="form-input" rows="8"></textarea>
                </div>
            </div>

            <div class="modal-footer">
                <button onclick="closeModal('addTestModal')" class="btn btn-secondary">Cancel</button>
                <button onclick="saveTest()" class="btn btn-primary">Create Test</button>
            </div>
        </div>
    </div>

    <!-- Test Taking Modal -->
    <div id="testModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="testModalTitle">Test</h3>
                <div class="test-timer" id="testTimer">30:00</div>
            </div>

            <div class="modal-body">
                <div class="test-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="testProgressFill"></div>
                    </div>
                    <div class="progress-info">
                        Question <span id="currentQuestionNumber">1</span> of <span id="totalQuestions">10</span>
                    </div>
                </div>

                <div class="test-question">
                    <h4 id="questionText">Loading question...</h4>
                    <div class="test-options" id="testOptions">
                        <div class="text-center">Loading options...</div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <div class="test-navigation">
                    <button onclick="previousQuestion()" class="btn btn-secondary" id="prevBtn">← Previous</button>
                    <button onclick="nextQuestion()" class="btn btn-primary" id="nextBtn">Next →</button>
                    <button onclick="submitTest()" class="btn btn-success" id="submitBtn" style="display: none;">Submit Test</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>